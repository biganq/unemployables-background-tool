<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../dist/output.css" rel="stylesheet">
    <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CRC2Q3XZ6R"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'G-CRC2Q3XZ6R');
    </script>
</head>

<body>
    <div class="w-screen h-auto relative mx-auto">
        <div class="flex flex-col justify-center items-center space-y-5 absolute top-7 left-0 right-0 mx-auto">
            <div name="prewview" class="flex flex-col items-center justify-center space-y-6">
                <div class="text-gray-500 font-semibold text-2xl">Background tool for unemployables!</div>
                <div class="flex justify-center text-xs" onclick="copyText()">Donate ETH:
                    <p id="text" class="inline-block">0x628F331343097cCAc4e79d6A78f2f14Bc1Eb939d</p>
                    <input class="-z-20 absolute opacity-0" id="input">
                </div>
                <div>
                    <div class="flex flex-col justify-center items-center">
                        step1:upload your #unemployables pfp<br>
                        step2:type something or not<br>
                        step3:click the generate button<br>
                        step4:download the picture.<br>(long press the picture to download if using cellphone)<br>
                        <span class="text-green-500 ">Because of the CSS framework, the mutation can only be getted using screenshot</span>
                    </div>
                </div>
                <div id="imgPre" class="flex justify-center items-center">
                    <img src="../imgs/test.png" class="w-72 h-72">
                </div>

            </div>
            <form action="upload" method="post" enctype="multipart/form-data" class="relative">
                <div class="p-4 bg-blue-300 rounded-lg font-semibold shadow hover:bg-blue-400 text-center">
                    Upload one unemployables PFP
                </div>
                <input type="file" name="pic" id="pic" onchange="picUpload();"
                    class="absolute top-0 h-fit px-2 py-3  opacity-0">
            </form>
            <form name="myForm">
                <input name="inputBar" type="text" placeholder="type in something or not"
                    class=" border border-blue-200 p-3 rounded-lg w-fit">
            </form>
            <div class=" border border-black">
                <button id="pcWall"
                    class="py-3 px-5 mr-2 bg-blue-300 rounded-lg font-semibold shadow hover:bg-blue-400">for
                    pc</button>
                <button id="cellPhone"
                    class="py-3 px-5 mr-2 bg-blue-300 rounded-lg font-semibold shadow hover:bg-blue-400">for
                    cellphone</button>
                <button id="test" class="py-3 px-5 mr-2 bg-blue-300 rounded-lg font-semibold shadow hover:bg-blue-400 hidden">for
                    test</button>

                <button id="singlecolor"
                    class="py-3 px-5 bg-blue-300 rounded-lg font-semibold shadow hover:bg-lime-500 hover:text-red-500 hover:uppercase">mutant</button>
            </div>
            <div class="absolute -left-510">
                <div id="workspace-phone" class="bg-neutral-200 w-97.5 h-211 relative">
                    <div
                        class="absolute top-0 left-0 right-0 bottom-0 m-auto flex flex-col justify-center items-center">
                        <div id="work-phone" class="w-20 h-20">
                            <img src="../imgs/test.png" class="w-20 h-20">
                        </div>

                        <div id="genPhoneHere" class="py-3 font-semibold text-center w-2/3 overflow-hidden ">
                            happy new year
                        </div>
                    </div>

                </div>
            </div>
            <div class="absolute -left-510">
                <div id="workspace-pc" class="bg-neutral-200 w-480 h-270 relative">
                    <div
                        class="absolute top-0 left-0 right-0 bottom-0 m-auto flex flex-col justify-center items-center">
                        <div id="work-pc">
                            <img src="../imgs/test.png" class="w-24 h-24">
                        </div>

                        <div id="genPcHere" class="py-3 font-semibold text-center w-2/3 overflow-hidden ">happy new
                            year!</div>
                    </div>
                </div>
            </div>
            <div class="hue-rotate-60 w-72 h-72 absolute -left-510" id="workspace-single">
                <div id="work-single">
                    <img src="../imgs/test.png">
                </div>
            </div>

            <div id="result-pc" class="flex flex-col justify-center items-center ">

            </div>
            <div id="result-phone" class="flex flex-col justify-center items-center ">

            </div>
            <div id="result-single" class="flex flex-col justify-center items-center p-10">

            </div>
        </div>
    </div>
    <script src="https://cdn.bootcdn.net/ajax/libs/dom-to-image/2.6.0/dom-to-image.js"></script>

    <script type="text/javascript">
        //画单色版图
        let drawSingle = function () {
            //document.getElementById("genPcHere").innerText = document.getElementsByName("inputBar")[0].value
            //console.log(document.getElementById("genPcHere").innerText)
            html2canvas(document.getElementById("workspace-single")).then(canvas => {
                document.getElementById("result-single").className =
                    "flex flex-col justify-center items-center w-72 h-72 hue-rotate-60";
                //canvasToImg
                let img = new Image();
                img.setAttribute("crossOrigin", 'Anonymous')
                img.src = canvas.toDataURL('image/jpeg', 1)
                img.onload = function (e) {
                    //document.getElementById("result-phone").append(canvas);
                    document.getElementById("result-single").append(img)
                }
                //document.getElementById("result-pc").append(canvas)
                console.log(img)
            });
        }
        //dom-to-image获取滤镜照片
        //import domtoimage from 'dom-to-image'
        document.getElementById("test").onclick = function () {
            console.log("22222")
            drawSingle2()
        }

        let drawSingle2 = function () {

        }

        //画canvas图手机版
        let drawUmPhone = function () {
            document.getElementById("genPhoneHere").innerText = document.getElementsByName("inputBar")[0].value
            //console.log(document.getElementById("genPhoneHere").innerText)
            html2canvas(document.getElementById("workspace-phone")).then(canvas => {
                document.getElementById("result-phone").className =
                    "flex flex-col justify-center items-center";
                //canvasToImg
                let img = new Image();
                img.setAttribute("crossOrigin", 'Anonymous')
                img.src = canvas.toDataURL('image/jpeg', 1)
                img.onload = function (e) {
                    //document.getElementById("result-phone").append(canvas);
                    document.getElementById("result-phone").append(img)
                }
            });
        }
        //画canvas图电脑版
        let drawUmPc = function () {
            document.getElementById("genPcHere").innerText = document.getElementsByName("inputBar")[0].value
            console.log(document.getElementById("genPcHere").innerText)
            html2canvas(document.getElementById("workspace-pc")).then(canvas => {
                document.getElementById("result-pc").className =
                    "flex flex-col justify-center items-center";
                //canvasToImg
                let img = new Image();
                img.setAttribute("crossOrigin", 'Anonymous')
                img.src = canvas.toDataURL('image/jpeg', 1)
                img.onload = function (e) {
                    //document.getElementById("result-phone").append(canvas);
                    document.getElementById("result-pc").append(img)
                }
                //document.getElementById("result-pc").append(canvas)
            });
        }
        document.getElementById("cellPhone").onclick = function () {
            document.getElementById("result-pc").className = "hidden"
            document.getElementById("result-phone").className = "hidden"
            document.getElementById("result-pc").innerHTML = ""
            document.getElementById("result-phone").innerHTML = ""
            drawUmPhone()
        }
        document.getElementById("pcWall").onclick = function () {
            document.getElementById("result-pc").className = "hidden"
            document.getElementById("result-phone").className = "hidden"
            document.getElementById("result-pc").innerHTML = ""
            document.getElementById("result-phone").innerHTML = ""
            drawUmPc()
        }
        document.getElementById("singlecolor").onclick = function () {
            document.getElementById("result-pc").className = "hidden"
            document.getElementById("result-phone").className = "hidden"
            document.getElementById("result-single").className = "hidden"
            document.getElementById("result-pc").innerHTML = ""
            document.getElementById("result-phone").innerHTML = ""
            document.getElementById("result-single").innerHTML = ""
            drawSingle()
        }
        //转化canvas添加为图片
        function addImg(node, url) {
            var img = new Image('288', '288');
            img.src = url;
            document.getElementById(node).innerHTML = "";
            document.getElementById(node).append(img)
        }

        function picUpload() {
            let pic = document.getElementById("pic"); //获取input对象
            let image = pic.value;
            let extStart = image.lastIndexOf(".");
            let ext = image.substring(extStart, image.length).toUpperCase();
            if (ext != ".PNG" && ext != ".GIF" && ext != ".JPG" && ext != ".JPEG") {
                alert("only for PNG,JPEG,GIF");
                return false;
            }
            var file = pic.files[0]; //获取input上传的图片信息
            var url = window.URL.createObjectURL(file); //得到bolb对象路径，赋值给<img>标签的src属性
            addImg('imgPre', url)
            addImg('work-pc', url)
            addImg('work-phone', url)
            addImg('work-single', url)
        }

        function copyText() {
            var copytext = document.getElementById("text").innerText;
            var input = document.getElementById("input");
            input.value = copytext;
            input.select();
            document.execCommand("copy"); // 执行浏览器复制命令
            alert("copy sucessful!Donate me :)");
        }
    </script>
</body>

</html>